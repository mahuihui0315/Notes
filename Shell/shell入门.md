# Shell
shell是一个c开发的程序, 是使用linux的桥梁, 既是一种命令语言, 又是一种程序设计语言.

shell脚本是一种为shell编写的脚本程序.

shell编程和java, c等编程一样只要有一个能编写代码的文本编译器和能解释执行的脚本解释器就行.

Linux的shell种类很多, 最常用的为bash.

## 基本格式
1. shell脚本文件的后缀为.sh, 但扩展名并不影响脚本执行
2. 第一行一般为: #!/bin/bash, #!用于告知系统使用何种解释器来执行该脚本
3. 使用命令: chmod +x ./shell脚本.sh, 赋予shell脚本文件执行权限
4. 执行shell脚本文件: ./shell脚本.sh

## Shell变量

### 定义变量
基本格式: name="value" 

注意事项:   
1. 变量名和等号之间不能有空格
2. 变量命名只能是英文字母, 数字和下划线, 首字符不能是数字
3. 变量名中间不能有空格
4. 变量名不能使用shell的关键字


### 使用变量
基本格式: 变量前加美元符$

也可使用花括号\{}将变量名括起来用于界定变量范围

### 只读变量
格式：readonly 变量名

将变量定义为只读变量，更改只读变量会报错

### 删除变量
格式：unset 变量名

删除之后无法再次使用，无法删除只读变量

### 变量类型
1. 局部变量：在脚本或命令中定义，仅在当前shell中有效
2. 环境变量：所有程序可用，包括shell启动的程序，也可以使用shell脚本定义环境变量
3. shell变量：由shell程序设定的特殊变量，有一部分是环境变量，有一部分是局部变量

## Shell字符串
字符串是shell编程中最常用的数据类型，可以使用单引号，双引号或者不用引号

### 单引号
1. 单引号中的任何字符都会原样输出，因此单引号中字符串中的变量是无效的
2. 单引号字符串中不能出现单个引号，使用转义字符也不行，但是可以成对出现，作为字符串拼接使用

### 双引号
1. 双引号字符串中可以出现变量
2. 可以出现转义字符

### 字符串操作
1. 获取长度：echo ${#字符串名}
2. 提取字符串：echo ${字符串名:1:4}，从索引1开始提取4个字符
3. 拼接字符串："xxx"$字符串名"xxx"，"xxx${字符串名}xxx"

## Shell数组
使用圆括号来表示素组，使用空格来分割元素
例：ArrayName=(value0 value1 value2 ...)

也可单独定义各个元素
例：
ArrayName[0]=value0
ArrayName[1]=value1

### 数组操作
1. 读取一个元素：value=${ArrayName[index]}
2. 读取所有元素：echo ${ArrayName[@]}
3. 获取数组长度：length=${#ArrayName[@]}或者${#ArrayName[*]}
4. 获取单个元素的长度：length=${#ArrayName[index]}


## Shell注释
1. 单行注释：#
2. 多行注释：   
:<<EOF   
注释内容   
EOF

## Shell传递参数
可以在执行Shell脚本时向脚本传递参数，脚本内获取参数的格式为：$n
n为数字，代表传入参数的顺序，$0为文件名，$1为第一个参数，依次增加

实例：
```
#!/bin/bash

echo "Shell Arguments Input Test";
echo "Name of executed file: $0";
echo "First argument: $1";
echo "Second argument: $2";
echo "Third argument: $3";
```

### 其他的参数处理字符
1. `$#`：传递到脚本的参数个数
2. `$*`：以字符串的形式显示所有传递的参数
3. `$$`：脚本运行的当前进程号
4. `$!`：后台运行的最后一个进程的ID
5. `$@`：显示所有传递的参数
6. `$_`：显示shell使用的当前选项
7. `$?`：显示最后命令的退出状态，0表示没有错误

## Shell运算符
原生bash不支持数学运算，但是可以通过其他命令来实现，例如expr

### 算术运算符
1. 加法：expr \`$a + $b`
2. 减法：expr \`$a - $b`
3. 乘法：expr \`$a \* $b`
4. 除法：expr \`$a / $b`
5. 取余：expr \`$a % $b`
6. 赋值：a=$b
7. 相等：\[ $a == $b ]
8. 不相等：\[ $a != $b ]   

注：条件表达式与运算符、方括号之间要有空格

### 关系运算符
1. -eq：检测两个数是否相同，相同返回true
2. -ne：检测两个数是否不等，不等返回true
3. -gt：检测左边的数是否大于右边的，是则返回true
4. -lt：检测左边的数是否小于右边的，是则返回true
5. -ge：检测左边的数是否大于等于右边的，是则返回true
6. -le：检测左边的数是否小于等于右边的，是则返回true

### 布尔运算符
1. ！：非运算
2. -o：或运算
3. -a：与运算

### 逻辑运算符
1. &&：逻辑与
2. ||：逻辑或

### 字符串运算符
1. =：检测两个字符串是否相等，相等则返回true
2. ！=：检测两个字符串是否不等，不相等则返回true
3. -z：检测字符串长度是否为0，是0则返回true
4. -n：检测字符串长度是否不为0，不是0则返回true
5. $：检测字符串是否为空，不为空返回true

### 文件测试运算符
对文件进行相应判断，符合条件则返回true，基本格式：\[ 运算符 $文件名 ]
01. -b filename：检测文件是否为块设备文件
02. -c filename：检测文件是否为字符设备文件
03. -d filename：检测文件是否为目录
04. -f filename：检测文件是否为普通文件
05. -g filename：检测文件是否设置了SGID位
06. -k filename：检测文件是否设置了粘着位（Sticky Bit）
07. -p filename：检测文件是否有名管道
08. -u filename：检测文件是否设置了SUID位
09. -r filename：检测文件是否可读
10. -w filename：检测文件是否可写
11. -x filename：检测文件是否可执行
12. -s filename：检测文件是否不为空
13. -e filename：检测文件是否存在

### Shell echo命令
1. 显示普通字符串：echo "string"，双引号可以省略
2. 显示转义字符：echo "\"string\""
3. 显示变量：
read命令可以从标准输入中读取一行，并把输入行的值赋予指定的shell变量，
以下代码接收一个输入变量并打印出来
```
#!/bin/bash
read name
echo "$name"
````
4. 显示换行：echo -e "\n"，-e表示开启转义
5. 显示不换行：echo -e "\c"
6. 打印结果到指定的文件：echo "string" > filename
7. 原样输出字符串：echo '$name\"'，直接输出$name\"，既不读取变量也不转义字符
8. 显示命令执行结果：echo `date`，使用反引号，打印当前时间

### Shell printf命令
printf命令模仿了c的printf()命令，比echo的移植性更好

实例：
```
#!/bin/bash

printf "%-10s %-8c %-4d %-4.2f" hello world 111 1.222
```
运行上面的脚本之后会输出：hello     w     111 1.22

转义数列：

1. \a：警告字符
2. \b：后退
3. \c：抑制（不显示）输出结果中任何结尾的换行字符（只在%b格式指示符控制下的参数字符串中有效），而且，任何留在参数里的字符、任何接下来的参数以及任何留在格式字符串中的字符，都被忽略
4. \f：换页
5. \n：换行
6. \r：回车
7. \t：水平制表
8. \v：垂直制表
9. \\\：反斜杠